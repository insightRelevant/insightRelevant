name: Generate Snake

# Controla cuándo se ejecutará la acción. Esta acción se ejecuta cada 6 horas.
on:
  schedule:
    # Cada 6 horas
    - cron: "0 */6 * * *"

  # Este comando permite ejecutar la acción automáticamente desde la pestaña Actions.
  workflow_dispatch:

jobs:
  # Este flujo de trabajo contiene un solo trabajo llamado "build"
  build:
    # El tipo de runner donde se ejecutará el trabajo
    runs-on: ubuntu-latest

    # Pasos que representan una secuencia de tareas que se ejecutarán como parte del trabajo
    steps:
      # Verifica el repositorio bajo $GITHUB_WORKSHOP para que tu trabajo pueda acceder a él
      - uses: actions/checkout@v2

      # Genera la snake
      - uses: Platane/snk@master
        id: snake-gif
        with:
          github_user_name: GeekosServer
          # Estas dos líneas generan los archivos en una rama llamada "output", evitando que se llene la rama principal.
          gif_out_path: dist/github-contribution-grid-snake.gif
          svg_out_path: dist/github-contribution-grid-snake.svg

      # Muestra el estado del build. Facilita la depuración si hay algún problema.
      - run: git status

      # Empuja los cambios
      - name: Push changes
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          branch: master
          force: true

      - uses: crazy-max/ghaction-github-pages@v2.1.3
        with:
          # La rama de salida mencionada anteriormente
          target_branch: output
          build_dir: dist
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
